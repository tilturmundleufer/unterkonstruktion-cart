!function(){var t=document.querySelector("#fc-cart"),e=t?t.getAttribute("data-context"):null;if("cart"===e||"sidecart"===e||"checkout"===e){var n=document.getElementById("fc-cart-form"),r=!1;window.__ukc_ajax_updating=!1,function(){var t="ukc_foxy_session",e="ukc_foxy_session_name";function n(){try{var n=localStorage.getItem(t),r=localStorage.getItem(e)||"fcsid";if(n&&n.length>5)return{id:n,name:r}}catch(t){}return null}function r(){try{var n=document.querySelector('input[name="fcsid"], input[name="fc_sid"], input[name="fssid"]');if(n||(n=document.querySelector('input[type="hidden"][name*="sid"]')),n&&n.value){var r=n.name,o=n.value;if(o&&o.length>5)return localStorage.setItem(t,o),localStorage.setItem(e,r),console.log("[UKC] Session gespeichert:",r,"=",o.substring(0,10)+"..."),{id:o,name:r}}}catch(t){console.error("[UKC] Session speichern fehlgeschlagen:",t)}return null}function o(t){t&&t.id&&(document.querySelectorAll('a[href*="foxycart.com"]').forEach(function(e){var n=e.getAttribute("href")||"";if(n&&!n.includes("fcsid=")&&!n.includes("fc_sid=")&&!n.includes("fssid=")){var r=n.includes("?")?"&":"?";e.setAttribute("href",n+r+t.name+"="+t.id),console.log("[UKC] Session an Link angehängt:",n.substring(0,50)+"...")}}),document.querySelectorAll('form[action*="foxycart.com"]').forEach(function(e){var n=e.querySelector('input[name="fcsid"], input[name="fc_sid"], input[name="fssid"]');if(n)n.value!==t.id&&(n.value=t.id);else{var r=document.createElement("input");r.type="hidden",r.name=t.name,r.value=t.id,e.appendChild(r)}}))}function a(t){if(t&&window.FC)try{FC.sid&&""!==FC.sid||(FC.sid=t.id,console.log("[UKC] FC.sid gesetzt:",t.id.substring(0,10)+"..."))}catch(t){}}var c=n(),i=r()||c;i?(console.log("[UKC] Session verfügbar:",i.id.substring(0,10)+"..."),o(i),setTimeout(function(){a(i)},100)):console.log("[UKC] Keine Session gefunden - warte auf FoxyCart"),setTimeout(function(){var t=n()||r();t&&(o(t),a(t))},1500)}(),k(),setTimeout(k,1e3),setTimeout(k,3e3);var o,a=C(function(){if("undefined"!=typeof FC&&("checkout"===document.querySelector("#fc-cart")?.getAttribute("data-context")&&w()))try{FC.checkout&&FC.checkout.shipping&&FC.checkout.shipping.get_shipping_and_handling&&FC.checkout.shipping.get_shipping_and_handling()}catch(t){}},400);o=C(function(){x(),b();try{if("undefined"!=typeof FC&&FC.cart&&"function"==typeof FC.cart.getTaxes){var t=FC.cart.shipping_address||FC.json&&FC.json.shipping_address||{};FC.cart.getTaxes({address:t})}}catch(t){}},250),["#billing_company",'input[name="billing_company"]','input[data-fc-name="billing_company"]',"#shipping_company",'input[name="shipping_company"]','input[data-fc-name="shipping_company"]'].forEach(function(t){var e=document.querySelector(t);e&&["input","change","blur"].forEach(function(t){e.addEventListener(t,o)})}),setTimeout(function(){["#billing_company",'input[name="billing_company"]','input[data-fc-name="billing_company"]'].forEach(function(t){var e=document.querySelector(t);e&&["input","change","blur"].forEach(function(t){e.addEventListener(t,o)})})},800),window.testCustomerType=function(t){document.cookie="ukc_customer_type="+t+"; path=/",S()},window.showCookies=function(){};var c=document.cookie;setInterval(function(){document.cookie!==c&&(c=document.cookie,S())},1e3),T(),setTimeout(T,300),setTimeout(T,1e3),setTimeout(function(){try{F()}catch(t){}},200),document.addEventListener("change",function(t){t.target&&"fc_payment_method"===t.target.name&&"purchase_order"===t.target.value&&setTimeout(function(){try{T()}catch(t){}try{F()}catch(t){}},100)}),document.addEventListener("change",function(t){t.target&&"radio"===t.target.type&&t.target.name&&t.target.name.includes("shipping")&&setTimeout(function(){E().forEach(function(t){var e=sessionStorage.getItem("ukc_po_number");e&&(t.value=e,A(t))})},200)}),document.addEventListener("click",function(t){t.target&&(t.target.closest(".fc-shipping-rates__rate")||t.target.closest('[data-fc-id="shipping-results"]'))&&setTimeout(function(){E().forEach(function(t){var e=sessionStorage.getItem("ukc_po_number");e&&(t.value=e,A(t))})},300)}),document.addEventListener("fc:payment:method:ready",function(){setTimeout(function(){try{T(),F()}catch(t){}},50)}),setTimeout(F,500),setInterval(function(){E().forEach(function(t){var e=sessionStorage.getItem("ukc_po_number");if(!e)try{T(),e=sessionStorage.getItem("ukc_po_number")}catch(t){}!e||t.value===e&&t.readOnly&&t.hasAttribute("readonly")||(t.value=e,A(t))})},2e3);var i=null;if(document.addEventListener("input",function(t){var e=t.target;if(e&&"item-quantity-input"===e.getAttribute("data-fc-id")){if(L(e))return void console.log("[UKC Sidecart] Input Event - FoxyCart native handling");if(e.getAttribute("data-fc-item-id")){var n=parseInt(e.value||"1",10)||1;n<1&&(n=1),e.value=n,h(),clearTimeout(i),i=setTimeout(function(){v()},800)}}}),document.addEventListener("blur",function(t){var e=t.target;if(e&&"item-quantity-input"===e.getAttribute("data-fc-id")){if(L(e))return void console.log("[UKC Sidecart] Blur Event - FoxyCart native handling");clearTimeout(i),v()}},!0),document.addEventListener("click",function(t){var e=t.target.closest(".ukc-qty-btn");if(e){if(L(e))return void console.log("[UKC Sidecart] Button Click - FoxyCart native handling");t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation();var n=_(e.getAttribute("data-fc-item-id"));if(!n)return;var r=parseInt(n.value||"1",10)||1;return e.classList.contains("ukc-qty-minus")?r=Math.max(1,r-1):r+=1,console.log("[UKC Button] +/- Button geklickt, neue Menge:",r),n.value=r,h(),void v()}var o=t.target.closest(".ukc-remove-btn");if(o){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation();var a=o.getAttribute("data-fc-item-id"),c=document.querySelector('[data-fc-item-id="'+a+'"]');c&&(c.style.transition="opacity 0.3s ease, transform 0.3s ease",c.style.opacity="0",c.style.transform="translateX(-20px)",setTimeout(function(){c&&c.parentNode&&c.parentNode.removeChild(c)},300));var i=_(a);return i&&(i.value=0),h(),v(),void setTimeout(function(){0===document.querySelectorAll(".ukc-row[data-fc-item-id]").length&&I()},400)}},!1),window.innerWidth<=768||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))if(document.querySelector("[data-fc-sidecart]")){var u="https://unterkonstruktion.foxycart.com/cart",l=U();l&&l.id&&(u+="?"+l.name+"="+l.id);try{window.top.location.href=u}catch(t){window.location.href=u}}!function(){var t=!1;function e(){if(!t){var e=document.querySelector("[data-fc-sidecart]");if(e){var n=e.querySelector(".fc-cart__main__content.fc-container__grid");if(n)if(n.querySelector("[data-ukc-go-fullcart]"))t=!0;else{var r=document.createElement("a");r.className="ukc-btn ukc-btn--alt",r.setAttribute("data-ukc-go-fullcart","");var o="https://unterkonstruktion.foxycart.com/cart",a=U();a&&a.id&&(o+="?"+a.name+"="+a.id,console.log("[UKC] Warenkorb-Button mit Session erstellt:",a.id.substring(0,10)+"...")),r.href=o,r.target="_top",r.textContent="Zum Warenkorb";var c=document.createElement("div");c.className="ukc-sidecart-footer",c.style.margin="16px 16px 24px",c.appendChild(r),n.appendChild(c),r.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var e=U(),n="https://unterkonstruktion.foxycart.com/cart";e&&e.id&&(n+="?"+e.name+"="+e.id);try{window.top.location.href=n}catch(t){window.location.href=n}}),t=!0}}}}setTimeout(e,400),document.addEventListener("fc-render-complete",e)}(),document.addEventListener("click",function(t){if(t.target.closest('[data-fc-id="cart-empty-link"]')){t.preventDefault();var e=document.querySelectorAll(".ukc-row[data-fc-item-id]");e.forEach(function(t,e){setTimeout(function(){t.style.transition="opacity 0.3s ease, transform 0.3s ease",t.style.opacity="0",t.style.transform="translateX(-20px)",setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},300)},100*e)}),setTimeout(function(){h(),v(),I()},100*e.length+400)}},!1),document.addEventListener("click",function(t){t.target.closest(".fc-postal-code-entry__submit .fc-button")&&setTimeout(N,300)}),document.addEventListener("awesomecomplete:select",function(){setTimeout(N,200)}),["shipping_country","shipping_postal_code","shipping_city"].forEach(function(t){var e=document.querySelector('[name="'+t+'"]');e&&e.addEventListener("change",function(){setTimeout(N,100)})}),document.addEventListener("click",function(t){t.target.closest('.fc-button--submit, [data-fc-id="cart-continue-button"], [type="submit"], .fc-actions .fc-button--checkout')&&function(){try{var t=document.querySelector("#fc-cart-form")||document.querySelector('form[action*="/checkout"]')||document.querySelector("form");if(!t)return;t.querySelectorAll(["[data-fc-required]","[required]"].join(",")).forEach(function(t){var e=(t.value||"").trim();if("checkbox"===t.type||"radio"===t.type?t.checked:0!==e.length){t.classList.remove("ukc-invalid");var n=t.closest(".fc-form-group");n&&n.classList.remove("ukc-has-error")}else{t.classList.add("ukc-invalid");var r=t.closest(".fc-form-group");r&&r.classList.add("ukc-has-error")}})}catch(t){}}()},!0);var s=new MutationObserver(function(t){var e=!1;t.forEach(function(t){"childList"===t.type&&t.addedNodes.forEach(function(t){1===t.nodeType&&t.querySelector&&t.querySelector("tr[data-fc-coupon-container-id]")&&(e=!0)})}),e&&setTimeout(M,100)});setTimeout(function(){var t=document.querySelector("ul.fc-transaction")||document.body;t&&(s.observe(t,{childList:!0,subtree:!0}),M())},500),setTimeout(K,100),setTimeout(K,600);var d=new MutationObserver(function(){K()});try{d.observe(document.body,{childList:!0,subtree:!0})}catch(t){}var m=document.querySelector('[data-fc-id="block-shipping-results"]');if(m)new MutationObserver(function(){setTimeout(H,50)}).observe(m,{childList:!0,subtree:!0});document.addEventListener("click",function(t){t.target.closest('[data-fc-id="shipping-results"]')&&setTimeout(H,50)})}function p(){return document.querySelector("#fc-cart")?.dataset.locale||"de-DE"}function f(){return document.querySelector("#fc-cart")?.dataset.currency||"EUR"}function y(){try{var t=document.cookie.match(/(?:^|; )ukc_customer_type=([^;]+)/);return t?decodeURIComponent(t[1]):""}catch(t){return""}}function g(t){return new Intl.NumberFormat(p(),{style:"currency",currency:f()}).format(t)}function h(){console.log("[UKC recalcSummary] Wird aufgerufen");var t=0;document.querySelectorAll(".ukc-row").forEach(function(e){var n=e.querySelector('input[data-fc-id="item-quantity-input"]'),r=parseInt(n?.value||"0",10)||0,o=parseFloat(e.getAttribute("data-price-each")||"0")||0;t+=o*r;var a=e.querySelector(".ukc-row__total p");a&&(a.textContent=g(o*r))});var e=document.querySelector("[data-ukc-subtotal]");e&&(console.log("[UKC recalcSummary] Subtotal aktualisiert:",g(t)),e.textContent=g(t)),console.log("[UKC recalcSummary] Fertig - Tax und Total wurden NICHT angefasst")}function _(t){return document.querySelector('input[data-fc-id="item-quantity-input"][data-fc-item-id="'+t+'"]')}async function v(){if(n&&!r){if(!n.isConnected||!document.body.contains(n))return console.warn("[UKC] Form ist nicht im DOM verbunden - Skip AJAX"),void(r=!1);var t=window.location.hostname,e="";try{e=new URL(n.action).hostname}catch(t){}if(!(t===e||e.includes("foxycart.com")&&t.includes("foxycart.com")))return console.log("[UKC] Cross-Origin detected ("+t+" → "+e+") - Skip AJAX"),void(r=!1);r=!0,window.__ukc_ajax_updating=!0;try{var o=new FormData(n);o.set("cart","update");try{var a=document.cookie.match(/(?:^|; )ukc_customer_type=([^;]+)/),c=a?decodeURIComponent(a[1]):"",i=document.getElementById("ukc-customer-type-input");i&&(i.value=c),c&&o.set("customer_type",c)}catch(t){}h();var u=await fetch(n.action,{method:"POST",body:o,credentials:"include"}),l=await u.text();console.log("[UKC AJAX] Server-Response erhalten, HTML-Länge:",l.length);var s=(new DOMParser).parseFromString(l,"text/html"),d=s.querySelector("#fc-cart"),m=document.querySelector("#fc-cart");if(console.log("[UKC AJAX] Parser fertig, next:",!!d,"current:",!!m),d&&m){var g=d.querySelector(".ukc-items"),_=m.querySelector(".ukc-items");if(!g||!_)return void m.replaceWith(d);_.innerHTML=g.innerHTML;var v=d.querySelector(".ukc-summary-table"),b=m.querySelector(".ukc-summary-table");console.log("[UKC AJAX] AJAX-Update wird ausgeführt"),v&&b?(console.log("[UKC AJAX] Summary-Table gefunden, wird aktualisiert"),console.log("[UKC AJAX] VORHER - Tax:",b.querySelector("[data-ukc-tax-total]")?.textContent),console.log("[UKC AJAX] VORHER - Total:",b.querySelector("[data-ukc-total-order]")?.textContent),b.innerHTML=v.innerHTML,console.log("[UKC AJAX] NACHHER - Tax:",b.querySelector("[data-ukc-tax-total]")?.textContent),console.log("[UKC AJAX] NACHHER - Total:",b.querySelector("[data-ukc-total-order]")?.textContent)):console.log("[UKC AJAX] Summary-Table NICHT gefunden!",{nextSummaryTable:!!v,currSummaryTable:!!b});var S=d.querySelector("[data-fc-order-quantity-integer]"),k=m.querySelector("[data-fc-order-quantity-integer]");return void(S&&k&&(k.textContent=S.textContent))}p(),f();const t=s.querySelector("[data-ukc-subtotal]"),e=s.querySelector("[data-ukc-total-order]"),r=s.querySelector("[data-ukc-shipping]"),x=d?.getAttribute("data-context");x&&document.querySelectorAll("#fc-cart").forEach(function(t){t.setAttribute("data-context",x)}),t&&document.querySelectorAll("[data-ukc-subtotal]").forEach(function(e){e.innerHTML=t.innerHTML}),e&&document.querySelectorAll("[data-ukc-total-order]").forEach(function(t){t.innerHTML=e.innerHTML});const E=s.querySelector("[data-ukc-tax-total]");if(E){const t=document.querySelector("[data-ukc-tax-total]");t&&(t.innerHTML=E.innerHTML)}if(r){const t=document.querySelector("[data-ukc-shipping]");t&&(t.innerHTML=r.innerHTML)}var C=document.querySelector("#fc-cart")?.getAttribute("data-context");if("cart"===C&&document.querySelectorAll('.fc-transaction__shipping, [data-fc-id="button-toggle-multiship-details"], .fc-transaction__shipping-address').forEach(function(t){t?.parentElement?.removeChild(t)}),h(),"checkout"===C||"cart"===C){var q=y();"undefined"!=typeof FC&&FC.cart&&(FC.cart._original_billing_company||(FC.cart._original_billing_company=FC.cart.billing_company||""),FC.cart.billing_company=q);var w=document.getElementById("customer_type");w&&(w.value=q),"cart"===C&&"undefined"!=typeof FC&&FC.cart&&FC.cart.updateHash&&FC.cart.updateHash()}setTimeout(function(){T(),document.querySelectorAll("#purchase_order").forEach(function(t){var e=sessionStorage.getItem("ukc_po_number");e&&(t.value=e,A(t))})},100)}catch(t){n&&n.submit()}finally{r=!1,console.log("[UKC AJAX] AJAX-Update abgeschlossen, Auto-Updater wird in 500ms wieder aktiviert"),setTimeout(function(){console.log("[UKC AJAX] Auto-Updater wird jetzt wieder aktiviert"),window.__ukc_ajax_updating=!1,"function"==typeof window.__ukc_scheduleUpdate&&(console.log("[UKC AJAX] Triggere Auto-Updater manuell"),window.__ukc_scheduleUpdate())},500)}}}function y(){try{if("undefined"!=typeof FC&&FC.cart)if((FC.cart.billing_company||FC.cart.shipping_company||"").trim().length>0)return"firmenkunde"}catch(t){}for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var n=t[e].trim();if(0===n.indexOf("ukc_customer_type="))return n.substring(18)||"privat"}return"privat"}function b(){var t=document.querySelector("#fc-cart")?.getAttribute("data-context");if("undefined"!=typeof FC&&FC.cart){for(var e=["#billing_company",'input[name="billing_company"]','input[data-fc-name="billing_company"]','input[id*="billing"][id*="company"]','input[name*="billing"][name*="company"]'],n=["#shipping_company",'input[name="shipping_company"]','input[data-fc-name="shipping_company"]','input[id*="shipping"][id*="company"]','input[name*="shipping"][name*="company"]'],r="",o="",c=0;c<e.length;c++){if((i=document.querySelector(e[c]))&&i.value){r=i.value.trim();break}}for(c=0;c<n.length;c++){var i;if((i=document.querySelector(n[c]))&&i.value){o=i.value.trim();break}}FC.cart.billing_company=r,FC.cart.shipping_company=o;var u=document.querySelector('input[name="billing_company"], input[data-fc-name="billing_company"]'),l=document.querySelector('input[name="shipping_company"], input[data-fc-name="shipping_company"]');u&&(u.value=r),l&&(l.value=o),"checkout"===t&&a()}}function S(){var t=document.querySelector("#fc-cart")?.getAttribute("data-context");if("checkout"===t||"cart"===t){var e=y();try{b()}catch(t){}var n=document.getElementById("customer_type");n&&(n.value=e)}}function k(){['[data-fc-id="block-billing-address"]',".fc-transaction__billing",".fc-container__grid--billing",".fc-container__grid--billing-address"].forEach(function(t){document.querySelectorAll(t).forEach(function(t){t&&(t.style.display="block",t.style.visibility="visible")})});['input[name="billing_company"]','input[data-fc-name="billing_company"]',"#billing_company"].forEach(function(t){var e=document.querySelector(t);e&&(e.style.display="block",e.style.visibility="visible")})}function C(t,e){let n;return function(){clearTimeout(n),n=setTimeout(t,e)}}function q(t){var e=document.querySelector(t);return e&&e.value?String(e.value).trim():""}function w(){var t=q('[data-fc-name="billing_country"], input[name="billing_country"]'),e=q('[data-fc-name="billing_postal_code"], input[name="billing_postal_code"]'),n=q('[data-fc-name="shipping_country"], input[name="shipping_country"]'),r=q('[data-fc-name="shipping_postal_code"], input[name="shipping_postal_code"]');return t&&e||n&&r}function x(){var t=function(){var t=document.querySelector('[data-fc-id="checkout-form"]')||document.querySelector("#fc-checkout-form")||document.querySelector('form[action*="foxy"]')||document.querySelector("form");if(!t)return{billing:null,shipping:null};var e=t.querySelector('input[name="billing_company"], input[data-fc-name="billing_company"]'),n=t.querySelector('input[name="shipping_company"], input[data-fc-name="shipping_company"]');return e&&!e.getAttribute("data-fc-name")&&(e.setAttribute("data-fc-name","billing_company"),e.setAttribute("data-fc-tax-trigger","true")),n&&!n.getAttribute("data-fc-name")&&(n.setAttribute("data-fc-name","shipping_company"),n.setAttribute("data-fc-tax-trigger","true")),e||((e=document.createElement("input")).type="hidden",e.name="billing_company",e.setAttribute("data-fc-name","billing_company"),e.setAttribute("data-fc-tax-trigger","true"),e.id="ukc_billing_company_hidden",t.appendChild(e)),n||((n=document.createElement("input")).type="hidden",n.name="shipping_company",n.setAttribute("data-fc-name","shipping_company"),n.setAttribute("data-fc-tax-trigger","true"),n.id="ukc_shipping_company_hidden",t.appendChild(n)),{billing:e,shipping:n}}(),e=document.querySelector("#billing_company")||document.querySelector('input[name="billing_company"]')||document.querySelector('input[data-fc-name="billing_company"]'),n=document.querySelector("#shipping_company")||document.querySelector('input[name="shipping_company"]')||document.querySelector('input[data-fc-name="shipping_company"]'),r=e&&e!==t.billing?e.value||"":t.billing?.value||"",o=n&&n!==t.shipping?n.value||"":t.shipping?.value||"",c=window.__ukc_prev_billing_company||"",i=window.__ukc_prev_shipping_company||"",u=String(r||"")!==String(c||""),l=String(o||"")!==String(i||"");if(t.billing&&(t.billing.value=r,u))try{t.billing.dispatchEvent(new Event("change",{bubbles:!0}))}catch(t){}if(t.shipping&&(t.shipping.value=o,l))try{t.shipping.dispatchEvent(new Event("change",{bubbles:!0}))}catch(t){}"undefined"!=typeof FC&&FC.cart&&(u&&(FC.cart.billing_company=r),l&&(FC.cart.shipping_company=o)),(u||l)&&(window.__ukc_prev_billing_company=r,window.__ukc_prev_shipping_company=o,a())}function E(){var t=[];try{["#purchase_order",'[name="purchase_order"]','[data-fc-name="purchase_order"]'].forEach(function(e){document.querySelectorAll(e).forEach(function(e){e&&-1===t.indexOf(e)&&t.push(e)})})}catch(t){}return t}function A(t){if(t){t.readOnly=!0;try{t.setAttribute("readonly","readonly")}catch(t){}t.disabled=!1,t.style.backgroundColor="#f8f9fa",t.style.cursor="not-allowed",t.style.color="#6c757d",t.onclick=function(t){return t.preventDefault(),!1},t.onkeydown=function(t){return t.preventDefault(),!1},t.onkeyup=function(t){return t.preventDefault(),!1},t.onkeypress=function(t){return t.preventDefault(),!1},t.oninput=function(t){return t.preventDefault(),!1},t.onpaste=function(t){return t.preventDefault(),!1}}}function T(){var t=E(),e=t[0];if(e){var n=sessionStorage.getItem("ukc_po_number");if(n)t.forEach(function(t){t.value=n,A(t)});else if(!e.value){var r,o=new Date,a=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),i=String(o.getDate()).padStart(2,"0"),u=String(o.getHours()).padStart(2,"0"),l=String(o.getMinutes()).padStart(2,"0"),s=String(o.getSeconds()).padStart(2,"0"),d=String(Math.floor(1e4*Math.random())).padStart(4,"0"),m=document.querySelector("#customer_id")?.value,p=m&&"0"!==m,f=null;if(p)try{if("undefined"!=typeof FC&&FC.cart&&FC.cart.customer&&FC.cart.customer.attributes)for(var y=FC.cart.customer.attributes,g=0;g<y.length;g++)if("PBI"===y[g].name){f=y[g].value;break}}catch(t){}r=p&&f?"PBI-"+f+"-"+a+c+i+"-"+u+l+s+"-"+d:"UKC-"+a+c+i+"-"+u+l+s+"-"+d,sessionStorage.setItem("ukc_po_number",r),t.forEach(function(t){t.value=r,A(t)})}}}function F(){var t=document.getElementById("purchase_order")||document.querySelector('[name="purchase_order"]')||document.querySelector('[data-fc-name="purchase_order"]');t&&(new MutationObserver(function(e){e.forEach(function(e){"attributes"===e.type&&"readonly"===e.attributeName&&(t.readOnly||A(t))})}).observe(t,{attributes:!0,attributeFilter:["readonly","disabled","style"]}),new MutationObserver(function(t){t.forEach(function(t){"childList"===t.type&&t.addedNodes.forEach(function(t){if(1===t.nodeType){var e=null;try{e=t.querySelector?t.querySelector("#purchase_order")||t.querySelector('[name="purchase_order"]')||t.querySelector('[data-fc-name="purchase_order"]'):null}catch(t){}if(e||"purchase_order"===t.id){var n=e||t;setTimeout(function(){var t=sessionStorage.getItem("ukc_po_number");if(t)n.value=t,A(n);else try{T()}catch(t){}},50)}}})})}).observe(document.body,{childList:!0,subtree:!0}))}function L(t){return!!(t&&t.closest&&t.closest("[data-fc-sidecart]"))}function U(){try{var t=localStorage.getItem("ukc_foxy_session"),e=localStorage.getItem("ukc_foxy_session_name")||"fcsid";if(t&&t.length>5)return{id:t,name:e}}catch(t){}return null}function I(){var t=document.querySelector(".ukc-items");if(t&&!t.querySelector(".ukc-empty")){var e=document.createElement("div");e.className="ukc-empty",e.innerHTML='<div class="ukc-empty__content"><p class="ukc-empty__title">Ihr Warenkorb ist leer</p><a class="ukc-btn ukc-btn--primary" href="https://unterkonstruktion.de/">Weiter einkaufen</a></div>',e.style.opacity="0",e.style.transform="translateY(20px)",t.appendChild(e),setTimeout(function(){e.style.transition="opacity 0.5s ease, transform 0.5s ease",e.style.opacity="1",e.style.transform="translateY(0)"},50)}}function N(){try{if(!("checkout"===document.querySelector("#fc-cart")?.getAttribute("data-context")))return;if(!w())return;window.FC&&FC.checkout&&FC.checkout.shipping&&"function"==typeof FC.checkout.shipping.get_shipping_and_handling?a():["shipping_country","shipping_postal_code","shipping_city"].forEach(function(t){var e=document.querySelector('[name="'+t+'"]');e&&e.dispatchEvent(new Event("change",{bubbles:!0}))})}catch(t){}}function M(){try{var t=document.querySelector("#fc-cart")?.getAttribute("data-context");if("checkout"!==t)return;var e=document.querySelector("tr.fc-subtotal--row[data-fc-coupon-container-id]");if(!e)return;var n=e.querySelector(".fc-coupon__name")?.textContent?.trim(),r=e.querySelector(".fc-coupon__code")?.textContent?.trim(),o=e.querySelector(".fc-subtotal__value")?.textContent?.trim();if(!n||!o)return;var a=document.querySelector(".ukc-summary-table tbody");if(!a)return;var c=a.querySelector(".ukc-summary-discount");if(c){var i=c.querySelector(".ukc-summary-label"),u=c.querySelector(".ukc-summary-value");i&&(i.textContent=n+(r?" ("+r+")":"")),u&&(u.textContent=o)}else{a.querySelector('tr:has(.ukc-summary-label:contains("Lieferkosten"))');var l=a.querySelector(".ukc-summary-totalrow"),s=document.createElement("tr");s.className="ukc-summary-discount",s.innerHTML='<td class="ukc-summary-label">'+n+(r?" ("+r+")":"")+'</td><td class="ukc-summary-value" data-ukc-discount>'+o+"</td>",l?a.insertBefore(s,l):a.appendChild(s)}e.remove()}catch(t){}}function K(){try{if(!("checkout"===document.querySelector("#fc-cart")?.getAttribute("data-context")))return;var t=document.querySelector('[data-fc-id="block-customer-shipping"]')||document.querySelector(".fc-checkout__section--customer-shipping-address");if(!t)return;var e=document.querySelector("#use_different_addresses")||document.querySelector('[name="use_different_addresses"]');if(e){var n=e.closest(".fc-form-group");return void(n&&(n.style.display="",n.classList.remove("hidden")))}var r=document.createElement("div");r.className="fc-form-group fc-checkout__section--customer-billing-address__use-different-address",r.innerHTML='<div class="fc-container__grid--use-different-address">        <div class="fc-input-group-container--checkbox">          <label for="use_different_addresses" class="fc-form-label fc-form-label--different-address">            <input type="hidden" name="use_different_addresses" value="0" />            <input type="checkbox" id="use_different_addresses" name="use_different_addresses" value="1" checked />            Verwenden Sie eine andere Rechnungsadresse          </label>        </div>      </div>',t.appendChild(r);var o=document.querySelector('[data-fc-id="block-customer-billing"]')||document.querySelector(".fc-checkout__section--customer-billing-address"),a=r.querySelector("#use_different_addresses");a&&(a.addEventListener("change",function(){o&&(o.style.display=a.checked?"":"none")}),o&&(o.style.display=a.checked?"":"none"))}catch(t){}}function H(){if("checkout"===document.querySelector("#fc-cart")?.getAttribute("data-context")){var t=document.querySelector('[data-fc-id="shipping-results"]');if(t){var e=t.querySelector('input[name="shipping_service_id"]:checked'),n=t.querySelector('input[name="shipping_service_id"]');!e&&n&&(n.checked=!0,n.dispatchEvent(new Event("change",{bubbles:!0})))}}}}(),function(){var t=document.querySelector("#fc-cart");if(t){var e={sub:null,tax:null,ship:null,tot:null},n=!1,r=!1,o=null;if(window.__ukc_scheduleUpdate=u,window.MutationObserver)try{new MutationObserver(function(){u()}).observe(t,{childList:!0,subtree:!0})}catch(t){}document.addEventListener("DOMContentLoaded",s),"complete"!==document.readyState&&"interactive"!==document.readyState||s()}function a(t){try{return new Intl.NumberFormat("de-DE",{style:"currency",currency:window.FC&&FC.cart&&FC.cart.currency_code||"EUR"}).format(Number(t||0))}catch(e){return Number(t||0).toFixed(2)+" €"}}function c(t,e){return Math.abs(Number(t)-Number(e))<.005}function i(){if(n||window.__ukc_ajax_updating)console.log("[UKC Auto-Updater] Pausiert (updating="+n+", ajax="+window.__ukc_ajax_updating+")");else{var t=function(){if(!window.FC||!FC.cart)return null;var t=FC.cart;return{sub:Number(t.total_item_price||0),tax:Number(t.total_tax||0),ship:Number(t.total_shipping||t.total_future_shipping||0),tot:Number(t.total_order||Number(t.total_item_price||0)+Number(t.total_tax||0)+Number(t.total_shipping||0)||Number(t.total_future_shipping||0))}}();if(t){console.log("[UKC Auto-Updater] Läuft jetzt!",{sub:t.sub,tax:t.tax,ship:t.ship,tot:t.tot});var r=document.querySelector("[data-ukc-subtotal]"),o=document.querySelector("[data-ukc-tax-total]"),i=document.querySelectorAll("[data-ukc-shipping]"),u=document.querySelector("[data-ukc-total-order]");n=!0;try{r&&!c(e.sub,t.sub)&&(console.log("[UKC Auto-Updater] Subtotal: "+e.sub+" -> "+t.sub),r.textContent=a(t.sub)),o&&!c(e.tax,t.tax)&&(console.log("[UKC Auto-Updater] Tax: "+e.tax+" -> "+t.tax),o.textContent=a(t.tax)),i&&i.forEach&&(c(e.ship,t.ship)||(console.log("[UKC Auto-Updater] Shipping: "+e.ship+" -> "+t.ship),i.forEach(function(e){e.textContent=a(t.ship)}))),u&&!c(e.tot,t.tot)&&(console.log("[UKC Auto-Updater] Total: "+e.tot+" -> "+t.tot),u.textContent=a(t.tot)),e=t}finally{n=!1}}}}function u(){r||(r=!0,requestAnimationFrame(function(){r=!1,i(),clearTimeout(o),o=setTimeout(i,120)}))}function l(){var t=document.querySelector("#fc-cart");if(t){var e={sub:null,tax:null,ship:null,tot:null},n=!1,r=!1,o=null;if(window.MutationObserver)try{new MutationObserver(function(){u()}).observe(t,{childList:!0,subtree:!0})}catch(t){}document.addEventListener("fc:cart:update",l),document.addEventListener("fc:cart:change",l),document.addEventListener("DOMContentLoaded",s),"complete"!==document.readyState&&"interactive"!==document.readyState||s()}function a(t){try{return new Intl.NumberFormat("de-DE",{style:"currency",currency:window.FC&&FC.cart&&FC.cart.currency_code||"EUR"}).format(Number(t||0))}catch(e){return Number(t||0).toFixed(2)+" €"}}function c(t,e){return Math.abs(Number(t)-Number(e))<.005}function i(){if(!n&&!window.__ukc_ajax_updating){var t=function(){if(!window.FC||!FC.cart)return null;var t=FC.cart,e=Number(t.total_item_price||0),n=Number(t.total_shipping||t.total_future_shipping||0),r=Number(t.total_tax||0);return{sub:e,tax:r,ship:n,tot:Number(t.total_order||0)||e+r+n}}();if(t){var r=document.querySelector("[data-ukc-subtotal]"),o=document.querySelector("[data-ukc-tax-total]"),i=document.querySelectorAll("[data-ukc-shipping]"),u=document.querySelector("[data-ukc-total-order]");n=!0;try{r&&!c(e.sub,t.sub)&&(r.textContent=a(t.sub)),o&&!c(e.tax,t.tax)&&(o.textContent=a(t.tax)),i&&i.forEach&&(c(e.ship,t.ship)||i.forEach(function(e){e.textContent=a(t.ship)})),u&&!c(e.tot,t.tot)&&(u.textContent=a(t.tot)),e=t}finally{n=!1}}}}function u(){r||(r=!0,requestAnimationFrame(function(){r=!1,i(),clearTimeout(o),o=setTimeout(i,120)}))}function l(){console.log("FC CART EVENT TRIGGERED - updating summary"),u()}function s(){u(),["#billing_company",'input[name="billing_company"]','input[data-fc-name="billing_company"]'].forEach(function(t){var e=document.querySelector(t);e&&(e.addEventListener("input",function(){console.log("COMPANY INPUT TRIGGERED:",e.value),setTimeout(function(){if(window.FC&&FC.cart&&(FC.cart.billing_company=e.value,console.log("SET FC.cart.billing_company:",e.value),window.FC.checkout&&FC.checkout.shipping))try{console.log("CALLING get_shipping_and_handling()"),FC.checkout.shipping.get_shipping_and_handling()}catch(t){console.log("ERROR in get_shipping_and_handling:",t)}console.log("SCHEDULING UPDATE"),u()},1e3)}),e.addEventListener("change",function(){setTimeout(function(){if(window.FC&&FC.cart&&(FC.cart.billing_company=e.value,window.FC.checkout&&FC.checkout.shipping))try{FC.checkout.shipping.get_shipping_and_handling()}catch(t){}u()},1e3)}))}),setTimeout(i,300),setTimeout(i,800),setTimeout(i,1500)}}function s(){u(),setTimeout(i,300),setTimeout(i,800),setTimeout(i,1500),l()}}();